<div class="row">
  <div class="col-12 d-flex justify-content-center text-center">
    <div class="card">
      <div class="card-header card-header-primary">
        <ng-container *ngIf="user$ | async; else createTitle">
          <h4 class="card-title">{{ 'editUser' | translate }}</h4>
        </ng-container>
        <ng-template #createTitle>
          <h4 class="card-title">{{ 'addNewUser' | translate }}</h4>
        </ng-template>
      </div>

      <div class="card-body">
        <!-- csak akkor rendereljük, ha van user objektum -->
        <form *ngIf="user" #userForm="ngForm" (ngSubmit)="onSubmit(user)" novalidate>
          <input type="hidden" name="id" [(ngModel)]="user._id" />

          <h3 class="h5 text-secondary">{{ 'firstName' | translate }} *</h3>
          <div class="row">
            <div class="col-md-12">
              <div class="form-group">
                <input
                  type="text"
                  class="form-control"
                  name="firstName"
                  [(ngModel)]="user.firstName"
                  required
                  pattern="^[a-űA-ŰA-Za-z \-.,!()']{3,60}$"
                  #firstNameModel="ngModel"
                />
              </div>
              <div
                *ngIf="firstNameModel.invalid && (firstNameModel.dirty || firstNameModel.touched)"
                class="alert alert-danger"
                role="alert"
              >
                {{ 'firstNameValid' | translate }}
              </div>
            </div>
          </div>

          <h3 class="h5 text-secondary">{{ 'lastName' | translate }} *</h3>
          <div class="row">
            <div class="col-md-12">
              <div class="form-group">
                <input
                  type="text"
                  class="form-control"
                  name="lastName"
                  [(ngModel)]="user.lastName"
                  required
                  pattern="^[a-űA-ŰA-Za-z \-.,!()']{3,60}$"
                  #lastNameModel="ngModel"
                />
              </div>
              <div
                *ngIf="lastNameModel.invalid && (lastNameModel.dirty || lastNameModel.touched)"
                class="alert alert-danger"
                role="alert"
              >
                {{ 'lastNameValid' | translate }}
              </div>
            </div>
          </div>

          <h3 class="h5 text-secondary">{{ 'email' | translate }} *</h3>
          <div class="row">
            <div class="col-md-12">
              <div class="form-group">
                <input
                  type="email"
                  class="form-control"
                  name="email"
                  [(ngModel)]="user.email"
                  required
                  email
                  #emailModel="ngModel"
                />
              </div>
              <div
                *ngIf="emailModel.invalid && (emailModel.dirty || emailModel.touched)"
                class="alert alert-danger"
                role="alert"
              >
                {{ 'emailValid' | translate }}
              </div>
            </div>
          </div>

          <h3 class="h5 text-secondary">{{ 'role' | translate }} *</h3>
          <div class="row">
            <div class="col-md-12">
              <div class="form-group">
                <input
                  type="number"
                  class="form-control"
                  name="role"
                  [(ngModel)]="user.role"
                  required
                  pattern="^[1-3]{1}$"
                  #roleModel="ngModel"
                />
              </div>
              <div
                *ngIf="roleModel.invalid && (roleModel.dirty || roleModel.touched)"
                class="alert alert-danger"
                role="alert"
              >
                {{ 'roleValid' | translate }}
              </div>
            </div>
          </div>

          <h3 class="h5 text-secondary">{{ 'Password' | translate }} *</h3>
          <div class="row">
            <div class="col-md-12">
              <div class="form-group">
                <input
                  type="password"
                  class="form-control"
                  name="password"
                  [(ngModel)]="user.password"
                  required
                  pattern="^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{7,}$"
                  #passwordModel="ngModel"
                />
              </div>
              <div
                *ngIf="passwordModel.invalid && (passwordModel.dirty || passwordModel.touched)"
                class="alert alert-danger"
                role="alert"
              >
                {{ 'passValid2' | translate }}
              </div>
            </div>
          </div>

          <!-- csak type="submit", nincs (click) -> nincs dupla submit/reload -->
          <button
            *ngIf="user$ | async"
            [disabled]="userForm.invalid"
            type="submit"
            class="btn btn-primary pull-right me-md-3"
          >
            {{ 'updateUser' | translate }}
          </button>

          <button
            *ngIf="!(user$ | async)"
            [disabled]="userForm.invalid"
            type="submit"
            class="btn btn-primary pull-right me-md-3"
          >
            {{ 'createUser' | translate }}
          </button>

          <button routerLink="/users" type="button" class="btn btn-danger pull-left">
            {{ 'cancelEdit' | translate }}
          </button>

          <div class="clearfix"></div>
        </form>
      </div>
    </div>
  </div>

  <div class="col-md-4"></div>
</div>
